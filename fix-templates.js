jQuery(function ($) {
  var templates="";
  templates += "";
  templates += "<!--";
  templates += "  Reason for separating templates: Refreshing the entire datepicker during interaction confuses screen readers, specfically because";
  templates += "  the grid heading is marked up as a live region and will often not update if it's destroyed and recreated instead of just having its";
  templates += "  text change. Additionally, interacting with the prev and next links would cause loss of focus issues because the links being interacted";
  templates += "  with will disappear while focused. With this approach there are 3 templates: the outer template (#ui-datepicker-tmpl), The grid template";
  templates += "  (#ui-datepicker-grid-tmpl) and the title template (#ui-datepicker-title-tmpl). This gets rid of the accessibility problems mentioned, and";
  templates += "  also allows developers to modify parts of the datepicker without having to duplicate the entire template.";
  templates += "-->";
  templates += "<script id=\"ui-datepicker-grid-tmpl\" type=\"text\/x-jquery-tmpl\">";
  templates += "  <table class=\"ui-datepicker-calendar\" role=\"grid\" aria-readonly=\"true\" aria-labelledby=\"${instance.id}-month-lbl\" tabindex=\"0\" aria-activedescendant=\"${instance.id}-${instance.focusedDay}\">";
  templates += "    <thead role=\"presentation\">";
  templates += "      <tr role=\"row\">";
  templates += "        {{each(index, day) date.weekdays()}}";
  templates += "        <th class=\"\" role=\"columnheader\" abbr=\"${day.fullname}\" aria-label=\"${day.fullname}\"><span title=\"${day.fullname}\">${day.shortname}<\/span><\/th>";
  templates += "        {{\/each}}";
  templates += "      <\/tr>";
  templates += "    <\/thead>";
  templates += "    <tbody role=\"presentation\">";
  templates += "      {{each(weekIndex, week) date.days()}}";
  templates += "      <tr role=\"row\">";
  templates += "        {{each(dayIndex, day) week.days}}";
  templates += "        <td {{if day.render}}id=\"${instance.id}-${day.date}\"{{\/if}} role=\"gridcell\" aria-selected=\"{{if day.current}}true{{else}}false{{\/if}}\" {{if !day.selectable}}aria-disabled=\"true\"{{\/if}}>";
  templates += "          {{if day.render}}";
  templates += "          {{if day.selectable}}";
  templates += "          <a class=\"{{if day.date == instance.focusedDay}}ui-state-focus {{\/if}}ui-state-default{{if day.current}} ui-state-active{{\/if}}{{if day.today}} ui-state-highlight{{\/if}} ${day.extraClasses}\" href=\"#\" tabindex=\"-1\" data-timestamp=${day.timestamp}>";
  templates += "            ${day.date}";
  templates += "            {{if day.today}} <span class=\"ui-helper-hidden-accessible\">, ${labels.currentText}<\/span>{{\/if}}";
  templates += "          <\/a>";
  templates += "          {{\/if}}";
  templates += "          {{if !day.selectable}}";
  templates += "          <span class=\"{{if day.current}} ui-state-active{{\/if}}{{if day.today}} ui-state-highlight{{\/if}} ${day.extraClasses}\">";
  templates += "            ${day.date}";
  templates += "          <\/span>";
  templates += "          {{\/if}}";
  templates += "          {{\/if}}";
  templates += "        <\/td>";
  templates += "        {{\/each}}";
  templates += "      <\/tr>";
  templates += "      {{\/each}}";
  templates += "    <\/tbody>";
  templates += "  <\/table>";
  templates += "<\/script>";
  templates += "";
  templates += "<script id=\"ui-datepicker-title-tmpl\" type=\"text\/x-jquery-tmpl\">";
  templates += "  <span class=\"ui-datepicker-month\">${date.monthname()}<\/span> <span class=\"ui-datepicker-year\">${date.year()}<\/span>";
  templates += "<\/script>";
  templates += "";
  templates += "<script id=\"ui-datepicker-tmpl\" type=\"text\/x-jquery-tmpl\">";
  templates += "  <div class=\"ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all\" role=\"region\" aria-labelledby=\"${instance.id}-title\">";
  templates += "    <div class=\"ui-datepicker-header ui-widget-header ui-helper-clearfix ui-corner-all\">";
  templates += "      <a href=\"#\" class=\"ui-datepicker-prev ui-corner-all\" title=\"${labels.prevText}\"><span class=\"ui-icon ui-icon-circle-triangle-w\">${labels.prevText}<\/span><\/a>";
  templates += "      <a href=\"#\" class=\"ui-datepicker-next ui-corner-all\" title=\"${labels.nextText}\"><span class=\"ui-icon ui-icon-circle-triangle-e\">${labels.nextText}<\/span><\/a>";
  templates += "      <div role=\"header\" id=\"${instance.id}-title\">";
  templates += "        <div id=\"${instance.id}-month-lbl\" class=\"ui-datepicker-title\">";
  templates += "          {{tmpl({date : date}) \"#ui-datepicker-title-tmpl\"}}";
  templates += "        <\/div>";
  templates += "        <span class=\"ui-helper-hidden-accessible\">, ${labels.datePickerRole}<\/span>";
  templates += "      <\/div>";
  templates += "    <\/div>";
  templates += "    {{tmpl({date : date, labels : labels, instance : instance}) \"#ui-datepicker-grid-tmpl\"}}";
  templates += "    <div class=\"ui-datepicker-buttonpane ui-widget-content\">";
  templates += "      <button class=\"ui-datepicker-current\">${labels.currentText}<\/button>";
  templates += "      <button class=\"ui-datepicker-close\">${labels.closeText}<\/button>";
  templates += "    <\/div>";
  templates += "  <\/div>";
  templates += "<\/script>";
  $("body").append(templates);
});
